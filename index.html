<!DOCTYPE html>
<html>
<head>
<link href="content/style.css" media="screen" rel="stylesheet"
	type="text/css">

<script src="webOSjs-0.1.0/webOS.js" charset="utf-8"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script type="text/javascript">
	   //sample code for calling LS2 API
       var lunaReq= webOS.service.request("luna://com.palm.systemservice",
        {
            method:"clock/getTime",
            parameters:{},
            onSuccess: function (args) {
				console.log("UTC:", args.utc);
            },
            onFailure: function (args) {
            }
        });
	</script>


<script>
	
	(function() {

		var game_id, game_name, top_header;
		
			//FRONT PAGE
		  $.ajax({
	            url: 'https://api.twitch.tv/kraken/games/top?limit=100&offset=0',
	            type: 'GET',
	            contentType: 'application/json',
	            dataType: 'jsonp',
	            success: function(data) {
	            	
	            	$.each(data.top, function(index, value){
	            		
	            		game_id = value.game._id;
	            		game_name = value.game.name;
	            		
	            		$("#twitch-widget-gamelist").append("<a name='" + game_name + "' id='" + game_id + "' href='#' ><img src='" + value.game.box.medium + "'></a>");
	            		
	            	})
	            	
	            	
	            }
			}); 
		  
			
		  // CLICK A GAME :: WHEN CKICK A GAME IMAGE -> SHOW LIST OF STREAMERS
		  $(document).on("click", "#twitch-widget-gamelist a", function(e) {
			  e.preventDefault();
			  var id = $(this).attr("id");
			  var name = $(this).attr("name");
			  
			  $("#game-list-header").text(name);
			  
			  name = name.replace(/\s/g,"+");
			  name = name.replace(/\:/g,"%3A");
			  
			  $("#twitch-widget-gamelist").empty();
			  
			  $.ajax({
		            url: 'https://api.twitch.tv/kraken/streams?game=' + name + '&limit=100',
		            type: 'GET',
		            contentType: 'application/json',
		            dataType: 'jsonp',
		            success: function(data) {
		            	
		            	$.each(data.streams, function(index, value){
		            			            		
		            		$("#twitch-widget-gamelist").append("<a href='#'><img src='" + value.preview.medium + "'></a>");
		            		
		            	})
		            }
				});
			});
		  
		  
		  // CLICK CHANNELS
		  $(document).on("click", "#channels", function(e) {
			  
			  $("#game-list-header").text("Channels");
			  
			  $("#twitch-widget-gamelist").empty();
			  
			  $.ajax({
		            url: 'https://api.twitch.tv/kraken/streams?limit=100',
		            type: 'GET',
		            contentType: 'application/json',
		            dataType: 'jsonp',
		            success: function(data) {
		            	
		            	$.each(data.streams, function(index, value){
		            			            		
		            		$("#twitch-widget-gamelist").append("<a href='#'><img src='" + value.preview.medium + "'></a>");
		            		
		            	})
		            }
				});
			  
			  
			  
			  
			  
		  });
		  
		  
		  
		  

		})();
	
	</script>

</head>
<body>
	<div class="left_panel">
		<div class="logo">
			<img src="content/twitch_logo_trans.png" alt="">
		</div>

		<div class="left_panel_menu">
			<h1>BROWSE</h1>
			<ul class="left_panel_menu_list">
				<li>
					<a href="index.html">Games</a>
				</li>
				<li>
					<a href="#" id="channels">Channels</a>
				</li>
			</ul>

		</div>


	</div>


	<div class="right_panel">
		<h1 id="game-list-header">All Games</h1>
		<input type="search" placeholder="Search Game [NOT WORKING]" class="search">
		<div class="clear"></div>
			
		<div class="twitch-widget-gamelist" id="twitch-widget-gamelist"></div>

	</div>
	<div style="clear: both;"></div>
</body>
</html>
